<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MDE8PXF500"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-MDE8PXF500');
    </script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5010155177671764"
        crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-5010155177671764">
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta name="description" content="Search The She Archive - Find stories, inventions, and essays about women's contributions across science, technology, arts, and society." />
    <meta property="og:title" content="Search | The She Archive" />
    <meta property="og:description" content="Search The She Archive - Find stories, inventions, and essays about women's contributions." />
    <meta property="og:image" content="https://theshearchive.com/images/prvimg.jpeg" />
    <meta property="og:url" content="https://theshearchive.com/search/" />
    <meta name="theme-color" content="#008080" />
    <title>Search | The She Archive</title>
    <link rel="icon" type="image/png" href="/images/tsa.png" />
    <link rel="apple-touch-icon" href="/images/tsa.png" />
    <link href="https://fonts.googleapis.com/css2?family=Alex+Brush&family=Space+Grotesk:wght@300;400;500;600;700&family=Playfair+Display:wght@700;900&family=Noto+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries,typography"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#8c2bee",
                        "brand-teal": "#008080",
                        "brand-gold": "#D4AF37",
                        "background-light": "#f7f6f8",
                        "background-dark": "#191022",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"],
                        "serif": ["Playfair Display", "serif"]
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        .brand-heading { font-family: "Playfair Display", serif }
        .brand-logo { font-family: "Alex Brush", "Playfair Display", serif }
        .post-content, .post-content :where(h1,h2,h3,h4,h5,h6,p,li,blockquote,figcaption,em,strong,a,span) {
            font-family: "Times New Roman", Times, serif;
        }
        .filter-btn {
            outline: none !important;
            -webkit-tap-highlight-color: transparent;
        }
        .filter-btn:focus {
            outline: none !important;
            box-shadow: none !important;
        }
        .filter-btn:focus-visible {
            outline: 2px solid #008080;
            outline-offset: 2px;
        }
        .filter-btn.active {
            background-color: #008080;
            color: white;
            border-color: #008080;
        }
    </style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-[#141118] dark:text-white">
    <div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            <header class="sticky top-0 z-50 w-full whitespace-nowrap border-b border-solid border-[#f2f0f4] bg-white/95 dark:bg-background-dark/95 backdrop-blur-sm">
                <div class="px-4 py-4 md:py-6 md:px-8 lg:px-12">
                    <div class="flex flex-col items-center gap-2">
                        <a href="/" class="brand-logo text-3xl font-black text-brand-teal dark:text-brand-gold text-center tracking-[0.12em] hover:opacity-80 transition-opacity md:text-4xl lg:text-5xl">The She Archive</a>
                        <div class="w-full max-w-5xl border-t border-[#d6d6d6] dark:border-white/20"></div>
                        <nav class="flex w-full max-w-5xl items-center justify-center gap-3 sm:gap-6 md:gap-8 text-[9px] font-semibold uppercase tracking-[0.16em] text-[#3c3741] dark:text-white/70 sm:text-[11px] md:text-xs">
                            <a class="pb-1 border-b border-transparent hover:border-brand-teal hover:text-brand-teal dark:hover:border-brand-gold dark:hover:text-brand-gold transition-colors" href="/stories/">Stories</a>
                            <a class="pb-1 border-b border-transparent hover:border-brand-teal hover:text-brand-teal dark:hover:border-brand-gold dark:hover:text-brand-gold transition-colors" href="/inventions/">Inventions</a>
                            <a class="pb-1 border-b border-transparent hover:border-brand-teal hover:text-brand-teal dark:hover:border-brand-gold dark:hover:text-brand-gold transition-colors" href="/editors-desk/">The Editor's Desk</a>
                            <a class="pb-1 border-b border-transparent hover:border-brand-teal hover:text-brand-teal dark:hover:border-brand-gold dark:hover:text-brand-gold transition-colors" href="/about/">About</a>
                            <a class="pb-1 border-b border-transparent hover:border-brand-teal hover:text-brand-teal dark:hover:border-brand-gold dark:hover:text-brand-gold transition-colors flex items-center" href="https://buymeacoffee.com/theshearchive" target="_blank" rel="noopener noreferrer" aria-label="Buy Me a Coffee">
                                <span class="material-symbols-outlined text-[14px] leading-none">coffee</span>
                            </a>
                        </nav>
                    </div>
                </div>
            </header>

            <main class="w-full max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">
                <!-- Search Header -->
                <div class="text-center mb-8">
                    <h1 class="brand-heading text-3xl sm:text-4xl text-[#141118] dark:text-white mb-4">Search the Archive</h1>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Explore stories, inventions, and essays across all collections</p>
                </div>

                <!-- Search Box -->
                <div class="max-w-2xl mx-auto mb-8">
                    <div class="relative">
                        <input
                            id="search-input"
                            class="w-full rounded-xl border-2 border-[#e0dbe6] bg-white dark:bg-white/10 p-4 pr-12 focus:ring-brand-teal focus:border-brand-teal text-base"
                            placeholder="Search by name, keyword, invention, topic..." 
                            type="text" 
                            autofocus />
                        <button id="search-btn" class="absolute right-3 top-1/2 -translate-y-1/2 p-2 text-brand-teal hover:text-brand-gold transition-colors">
                            <span class="material-symbols-outlined text-2xl">search</span>
                        </button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="mb-8 space-y-6">
                    <!-- Popular Categories -->
                    <div>
                        <h3 class="text-sm font-bold uppercase tracking-widest text-gray-500 mb-3">Popular Categories</h3>
                        <div class="flex flex-wrap gap-2">
                            <button data-category="Technology" class="filter-btn category-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-teal hover:text-brand-teal transition-colors">Tech Pioneers</button>
                            <button data-category="Science" class="filter-btn category-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-teal hover:text-brand-teal transition-colors">Scientific Discoveries</button>
                            <button data-category="Medical" class="filter-btn category-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-teal hover:text-brand-teal transition-colors">Medical Breakthroughs</button>
                            <button data-category="Finance" class="filter-btn category-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-teal hover:text-brand-teal transition-colors">Financial Innovators</button>
                            <button data-category="Arts" class="filter-btn category-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-teal hover:text-brand-teal transition-colors">Arts & Culture</button>
                            <button data-category="Activism" class="filter-btn category-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-teal hover:text-brand-teal transition-colors">Social Impact</button>
                        </div>
                    </div>

                    <!-- Era Filter -->
                    <div>
                        <h3 class="text-sm font-bold uppercase tracking-widest text-gray-500 mb-3">Filter by Era</h3>
                        <div class="flex flex-wrap gap-2">
                            <button data-era="19th Century" class="filter-btn era-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-gold hover:text-brand-gold transition-colors">19th Century</button>
                            <button data-era="Early 20th Century" class="filter-btn era-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-gold hover:text-brand-gold transition-colors">Early 20th Century</button>
                            <button data-era="Mid-20th Century" class="filter-btn era-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-gold hover:text-brand-gold transition-colors">Mid-20th Century</button>
                            <button data-era="Late 20th Century" class="filter-btn era-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-gold hover:text-brand-gold transition-colors">Late 20th Century</button>
                            <button data-era="21st Century" class="filter-btn era-btn px-4 py-2 rounded-full border border-[#e0dbe6] text-sm font-medium hover:border-brand-gold hover:text-brand-gold transition-colors">21st Century</button>
                        </div>
                    </div>

                    <!-- Clear Filters -->
                    <div class="flex items-center gap-4">
                        <button id="clear-filters" class="text-sm text-brand-teal hover:underline hidden">Clear all filters</button>
                        <span id="results-count" class="text-sm text-gray-500"></span>
                    </div>
                </div>

                <!-- Results -->
                <div id="search-results" class="space-y-8">
                    <p class="text-center text-gray-500 italic py-12">Enter a search term or select a filter to explore the archive...</p>
                </div>
            </main>

            <footer class="border-t border-[#e0dbe6] dark:border-white/10 py-8 sm:py-12 px-4 sm:px-6 md:px-8 lg:px-12 bg-white dark:bg-background-dark">
                <div class="flex flex-col md:flex-row justify-between items-center gap-6 sm:gap-8">
                    <div class="flex items-center gap-2 sm:gap-3">
                        <img src="/images/tsa.png" alt="TSA Logo" class="h-7 w-7 sm:h-8 sm:w-8 object-contain">
                        <h2 class="brand-heading text-lg sm:text-xl font-black text-brand-teal dark:text-brand-gold">The She Archive</h2>
                    </div>
                    <div class="flex flex-wrap justify-center gap-6 sm:gap-8 text-[#141118] dark:text-white/70 text-xs sm:text-sm">
                        <a class="hover:text-brand-teal transition-colors" href="/contact/">Contact</a>
                        <a class="hover:text-brand-teal transition-colors" href="/submissions/">Submissions</a>
                        <a class="hover:text-brand-teal transition-colors" href="/privacy/">Privacy Policy</a>
                    </div>
                    <div class="flex gap-3 sm:gap-4">
                        <a class="size-9 sm:size-10 flex items-center justify-center rounded-full bg-[#f2f0f4] dark:bg-white/5 hover:bg-brand-teal/20 hover:text-brand-teal transition-all"
                            href="https://buymeacoffee.com/theshearchive" target="_blank" rel="noopener noreferrer" aria-label="Support The She Archive">
                            <span class="material-symbols-outlined text-lg sm:text-xl">coffee</span>
                        </a>
                        <a class="size-9 sm:size-10 flex items-center justify-center rounded-full bg-[#f2f0f4] dark:bg-white/5 hover:bg-brand-teal/20 hover:text-brand-teal transition-all"
                            href="/coming-soon.html">
                            <span class="material-symbols-outlined text-lg sm:text-xl">rss_feed</span>
                        </a>
                        <a class="size-9 sm:size-10 flex items-center justify-center rounded-full bg-[#f2f0f4] dark:bg-white/5 hover:bg-brand-teal/20 hover:text-brand-teal transition-all text-black no-underline"
                            href="mailto:theshearchivehq@gmail.com" aria-label="Email us">
                            <span class="material-symbols-outlined text-lg sm:text-xl">mail</span>
                        </a>
                    </div>
                </div>
                <p class="text-center text-[#756189] text-xs mt-8 sm:mt-12">
                    Â© 2026 The She Archive. Celebrating contributions across Arts, Tech, Medical, Activism, Science and more.
                </p>
            </footer>
        </div>
    </div>

    <script>
        // Format date helper
        const formatDate = (value) => {
            if (!value) return '';
            const date = new Date(value);
            if (Number.isNaN(date.getTime())) return '';
            return date.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
        };

        // State
        let allData = { stories: [], inventions: [], editorials: [] };
        let activeCategory = null;
        let activeEra = null;
        let searchQuery = '';

        // DOM Elements
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const resultsContainer = document.getElementById('search-results');
        const resultsCount = document.getElementById('results-count');
        const clearFiltersBtn = document.getElementById('clear-filters');
        const categoryBtns = document.querySelectorAll('.category-btn');
        const eraBtns = document.querySelectorAll('.era-btn');

        // Load all data
        async function loadAllData() {
            try {
                const [storiesRes, inventionsRes, editorialsRes] = await Promise.all([
                    fetch('/api/posts.json?ts=' + Date.now()),
                    fetch('/api/inventions.json?ts=' + Date.now()),
                    fetch('/api/editorials.json?ts=' + Date.now())
                ]);

                allData.stories = await storiesRes.json();
                allData.inventions = await inventionsRes.json();
                allData.editorials = await editorialsRes.json();

                // Check URL params on load
                const params = new URLSearchParams(window.location.search);
                const q = params.get('q');
                const cat = params.get('category');
                const era = params.get('era');

                if (q) {
                    searchInput.value = q;
                    searchQuery = q;
                }
                if (cat) {
                    activeCategory = cat;
                    categoryBtns.forEach(btn => {
                        if (btn.dataset.category === cat) btn.classList.add('active');
                    });
                }
                if (era) {
                    activeEra = era;
                    eraBtns.forEach(btn => {
                        if (btn.dataset.era === era) btn.classList.add('active');
                    });
                }

                if (q || cat || era) {
                    performSearch();
                }
            } catch (error) {
                console.error('Error loading data:', error);
                resultsContainer.innerHTML = '<p class="text-center text-red-500">Error loading archive data. Please try again.</p>';
            }
        }

        // Search and filter logic
        function performSearch() {
            const query = searchQuery.toLowerCase().trim();
            let results = [];

            // Helper to check if item matches filters
            const matchesFilters = (item, type) => {
                // Text search
                if (query) {
                    const searchableText = [
                        item.title || '',
                        item.description || '',
                        item.author || '',
                        item.inventor || '',
                        item.body || '',
                        item.problem || '',
                        item.field || '',
                        item.category || '',
                        (item.categories || []).join(' '),
                        (item.tags || []).join(' ')
                    ].join(' ').toLowerCase();

                    if (!searchableText.includes(query)) return false;
                }

                // Category filter
                if (activeCategory) {
                    const categoryMap = {
                        'Technology': ['technology', 'tech', 'computing', 'computer science', 'engineering', 'robotics', 'ai'],
                        'Science': ['science', 'physics', 'chemistry', 'biology', 'mathematics', 'scientific'],
                        'Medical': ['medical', 'medicine', 'healthcare', 'health', 'nursing', 'pharmaceutical', 'clinical'],
                        'Finance': ['finance', 'financial', 'business', 'entrepreneurship', 'banking', 'economic'],
                        'Arts': ['arts', 'art', 'culture', 'music', 'visual', 'literature', 'fashion', 'film', 'theater'],
                        'Activism': ['activism', 'advocacy', 'social', 'gender', 'equity', 'education', 'policy']
                    };

                    const keywords = categoryMap[activeCategory] || [activeCategory.toLowerCase()];
                    const itemCategories = [
                        item.category || '',
                        item.field || '',
                        (item.categories || []).join(' '),
                        (item.tags || []).join(' ')
                    ].join(' ').toLowerCase();

                    if (!keywords.some(kw => itemCategories.includes(kw))) return false;
                }

                // Era filter
                if (activeEra) {
                    const itemEra = item.era || '';
                    const itemYear = item.year || '';
                    
                    // Check era field directly
                    if (itemEra && itemEra === activeEra) return true;
                    
                    // Infer era from year
                    if (itemYear) {
                        const yearNum = parseInt(itemYear);
                        if (!isNaN(yearNum)) {
                            const inferredEra = getEraFromYear(yearNum);
                            if (inferredEra === activeEra) return true;
                        }
                    }
                    
                    // If has era field but doesn't match, exclude
                    if (itemEra && itemEra !== activeEra) return false;
                    
                    // If no era info, exclude when era filter is active
                    if (!itemEra && !itemYear) return false;
                }

                return true;
            };

            // Get era from year
            function getEraFromYear(year) {
                if (year < 1900) return '19th Century';
                if (year < 1940) return 'Early 20th Century';
                if (year < 1970) return 'Mid-20th Century';
                if (year < 2000) return 'Late 20th Century';
                return '21st Century';
            }

            // Filter each collection
            allData.stories.forEach(item => {
                if (matchesFilters(item, 'story')) {
                    results.push({ ...item, type: 'story', url: `/stories/${item.slug}/` });
                }
            });

            allData.inventions.forEach(item => {
                if (matchesFilters(item, 'invention')) {
                    results.push({ ...item, type: 'invention', url: `/inventions/${item.slug}/` });
                }
            });

            allData.editorials.forEach(item => {
                if (matchesFilters(item, 'editorial')) {
                    results.push({ ...item, type: 'editorial', url: `/editors-desk/${item.slug}/` });
                }
            });

            // Sort by date (newest first)
            results.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));

            renderResults(results);
            updateURL();
        }

        // Render results
        function renderResults(results) {
            if (results.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="text-center py-12">
                        <span class="material-symbols-outlined text-6xl text-gray-300 mb-4">search_off</span>
                        <p class="text-gray-500">No results found. Try different keywords or filters.</p>
                    </div>
                `;
                resultsCount.textContent = '0 results';
                return;
            }

            resultsCount.textContent = `${results.length} result${results.length === 1 ? '' : 's'}`;

            const typeLabels = {
                'story': { label: 'Story', color: 'bg-brand-teal' },
                'invention': { label: 'Invention', color: 'bg-brand-gold' },
                'editorial': { label: "Editor's Desk", color: 'bg-purple-600' }
            };

            resultsContainer.innerHTML = results.map(item => {
                const typeInfo = typeLabels[item.type];
                const image = item.image || '/images/prvimg.jpeg';
                
                return `
                    <article class="flex gap-4 py-4 border-b border-[#e0dbe6] dark:border-white/10">
                        <div class="h-20 w-20 sm:h-24 sm:w-24 rounded-lg overflow-hidden bg-[#f2f0f4] dark:bg-white/5 shrink-0">
                            <img src="${image}" alt="${item.title}" class="h-full w-full object-cover" loading="lazy" />
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase text-white ${typeInfo.color}">${typeInfo.label}</span>
                                ${item.era ? `<span class="text-[10px] text-gray-500">${item.era}</span>` : ''}
                                ${item.year ? `<span class="text-[10px] text-brand-gold">${item.year}</span>` : ''}
                            </div>
                            <h3 class="brand-heading text-base sm:text-lg font-bold text-black dark:text-white mb-1 truncate">
                                <a href="${item.url}" class="hover:text-brand-teal transition-colors">${item.title}</a>
                            </h3>
                            <p class="text-xs text-gray-600 dark:text-gray-400 line-clamp-2 mb-2">${item.description || item.problem || ''}</p>
                            <div class="flex items-center gap-3 text-[10px]">
                                ${item.author ? `<span class="text-brand-gold">By ${item.author}</span>` : ''}
                                ${item.inventor ? `<span class="text-gray-500 italic">Inventor: ${item.inventor}</span>` : ''}
                                ${item.date ? `<span class="text-brand-teal">${formatDate(item.date)}</span>` : ''}
                            </div>
                        </div>
                    </article>
                `;
            }).join('');
        }

        // Update URL with current filters
        function updateURL() {
            const params = new URLSearchParams();
            if (searchQuery) params.set('q', searchQuery);
            if (activeCategory) params.set('category', activeCategory);
            if (activeEra) params.set('era', activeEra);

            const newURL = params.toString() ? `?${params.toString()}` : window.location.pathname;
            window.history.replaceState({}, '', newURL);

            // Show/hide clear button
            clearFiltersBtn.classList.toggle('hidden', !searchQuery && !activeCategory && !activeEra);
        }

        // Event Listeners
        searchInput.addEventListener('input', (e) => {
            searchQuery = e.target.value;
            performSearch();
        });

        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });

        searchBtn.addEventListener('click', performSearch);

        categoryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const category = btn.dataset.category;
                
                // Toggle off if already active
                if (activeCategory === category) {
                    activeCategory = null;
                    btn.classList.remove('active');
                } else {
                    // Remove active from all category buttons
                    categoryBtns.forEach(b => b.classList.remove('active'));
                    activeCategory = category;
                    btn.classList.add('active');
                }
                
                performSearch();
            });
        });

        eraBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const era = btn.dataset.era;
                
                // Toggle off if already active
                if (activeEra === era) {
                    activeEra = null;
                    btn.classList.remove('active');
                } else {
                    // Remove active from all era buttons
                    eraBtns.forEach(b => b.classList.remove('active'));
                    activeEra = era;
                    btn.classList.add('active');
                }
                
                performSearch();
            });
        });

        clearFiltersBtn.addEventListener('click', () => {
            searchQuery = '';
            activeCategory = null;
            activeEra = null;
            searchInput.value = '';
            categoryBtns.forEach(b => b.classList.remove('active'));
            eraBtns.forEach(b => b.classList.remove('active'));
            resultsContainer.innerHTML = '<p class="text-center text-gray-500 italic py-12">Enter a search term or select a filter to explore the archive...</p>';
            resultsCount.textContent = '';
            updateURL();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', loadAllData);
    </script>
</body>
</html>
